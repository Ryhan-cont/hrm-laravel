(window.webpackJsonp=window.webpackJsonp||[]).push([[56],{"7u9F":function(t,e,a){"use strict";a.r(e);var s=a("o0o1"),i=a.n(s);function n(t,e,a,s,i,n,r){try{var o=t[n](r),l=o.value}catch(t){return void a(t)}o.done?e(l):Promise.resolve(l).then(s,i)}function r(t){return function(){var e=this,a=arguments;return new Promise((function(s,i){var r=t.apply(e,a);function o(t){n(r,s,i,o,l,"next",t)}function l(t){n(r,s,i,o,l,"throw",t)}o(void 0)}))}}var o={components:{},data:function(){return{packageData:[],moduleData:[],inputModalSt:!1,modalTitle:null,modalType:null,name:"",description:"",period:"",periodvalue:"",nou:"",price:"",currency:"BDT",baseModuleData:[],periodOption:["day","week","month","year"],errorData:{}}},mounted:function(){this.loadData()},methods:{chkdata:function(){},loadData:function(){var t=this;return r(i.a.mark((function e(){var a,s;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,axios.get("/api/package/data");case 3:a=e.sent,s=a.data,t.packageData=s.package,t.baseModuleData=s.module,e.next=13;break;case 9:e.prev=9,e.t0=e.catch(0),t.notificationAlert(e.t0.response),console.log(e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,9]])})))()},moduleGrouping:function(t){for(var e=_.cloneDeep(t),a={},s=0;e.length>s;s++)a[e[s].id]=e[s];var i={};for(s=0;this.baseModuleData.length>s;s++){var n=this.baseModuleData[s];if(a[n.id]){var r=n.module_group;if(null!=r&&""!=r&&null!=r){if(!i[r]){var o={status:!1,name:r,type:"group",data:[]};i[r]=o}1==a[n.id].status&&(i[r].status=!0),i[r].data.push(a[n.id])}else{o={name:"general - ".concat(n.id),type:"general",data:[a[n.id]]};i["general - ".concat(n.id)]=o}}}return _.values(i)},inputModal:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(this.inputModalSt=!this.inputModalSt,this.modalType=t,"new"==t)this.modalTitle="Add new package",this.name="",this.description="",this.period="",this.periodvalue="",this.nou="",this.price="",this.currency="BDT",this.moduleData=this.moduleGrouping(_.cloneDeep(this.baseModuleData));else if("edit"==t){this.modalTitle="Edit package",this.name=e.name,this.description=e.description,this.period=e.period,this.periodvalue=e.periodvalue,this.nou=e.nou,this.price=e.price,this.currency=e.currency,this.id=e.id;var a=_.cloneDeep(this.baseModuleData),s=_.cloneDeep(e.permission),i=a.map((function(t){var e=s.filter((function(e){return e.moduleid==t.id}));if(e.length>0){t.status=!0;var a=t.subpermissions.map((function(t){var a=e[0].subpermissions.filter((function(e){return e.name==t.name}));return a.length>0?a[0]:t}));t.subpermissions=a}return t}));this.moduleData=this.moduleGrouping(_.cloneDeep(i))}},permissionChanged:function(t,e,a){var s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if("group"==s){var i=this.moduleData[t].status;this.moduleData[t].data.forEach((function(t){return t.subpermissions.forEach((function(t){return t.status=i})),t.status=i}))}else if("module"==s){1==(i=this.moduleData[t].data[e].status)&&(this.moduleData[t].status=!0),this.moduleData[t].data[e].subpermissions.forEach((function(t){return t.status=i}))}else if("sub"==s){1==(i=this.moduleData[t].data[e].subpermissions[a].status)&&(this.moduleData[t].data[e].status=!0)}},createPackage:function(){var t=this;return r(i.a.mark((function e(){var a,s;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.btnDisabled=!0,e.prev=1,a={name:t.name,description:t.description,period:t.period,periodvalue:t.periodvalue,nou:t.nou,price:t.price,currency:t.currency,permission:_.flattenDeep(_.map(t.moduleData,(function(t){return t.data})))},e.next=5,axios.post("/api/package/create",a);case 5:(s=e.sent)&&(t.inputModalSt=!1,t.btnDisabled=!1,t.notificationAlert(s),t.loadData()),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(1),t.btnDisabled=!1,t.notificationAlert(s);case 13:case"end":return e.stop()}}),e,null,[[1,9]])})))()},updatePackage:function(){var t=this;return r(i.a.mark((function e(){var a,s;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.btnDisabled=!0,e.prev=1,a={name:t.name,description:t.description,period:t.period,periodvalue:t.periodvalue,nou:t.nou,price:t.price,currency:t.currency,permission:_.flattenDeep(_.map(t.moduleData,(function(t){return t.data}))),id:t.id},e.next=5,axios.post("/api/package/update",a);case 5:(s=e.sent)&&(t.inputModalSt=!1,t.btnDisabled=!1,t.notificationAlert(s),t.loadData()),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(1),t.notificationAlert(e.t0.response),t.btnDisabled=!1;case 13:case"end":return e.stop()}}),e,null,[[1,9]])})))()},deleteData:function(t){this.$vs.dialog({type:"confirm",color:"danger",title:"Confirm",text:"Are you sure u want to delete this package?",acceptText:"ok",accept:this.deleteDataProceed,parameters:t})},deleteDataProceed:function(t){var e=this;return r(i.a.mark((function a(){var s,n;return i.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,s={id:t.id},a.next=4,axios.post("/api/package/delete",s);case 4:(n=a.sent)&&(e.notificationAlert(n),e.loadData()),a.next=11;break;case 8:a.prev=8,a.t0=a.catch(0),e.notificationAlert(a.t0.response);case 11:case"end":return a.stop()}}),a,null,[[0,8]])})))()}}},l=a("KHd+"),c=Object(l.a)(o,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("vx-card",{attrs:{title:"Product Manager"}},[a("div",[a("div",{staticClass:"flex"},[a("div",{staticClass:"flex-auto"}),t._v(" "),a("div",[a("vs-button",{attrs:{size:"small","icon-pack":"feather",icon:"icon-plus"},on:{click:function(e){return t.inputModal("new")}}},[t._v("Add New")])],1)]),t._v(" "),a("div",{staticClass:"pt-3",staticStyle:{"min-height":"300px"}},[a("vs-table",{attrs:{pagination:"",search:"",stripe:"",data:t.packageData},scopedSlots:t._u([{key:"default",fn:function(e){var s=e.data;return t._l(s,(function(e,s){return a("vs-tr",{key:s},[a("vs-td",{attrs:{data:e.name}},[t._v("\r\n              "+t._s(e.name)+"\r\n            ")]),t._v(" "),a("vs-td",{attrs:{data:e.description}},[t._v("\r\n              "+t._s(e.description)+"\r\n            ")]),t._v(" "),a("vs-td",{attrs:{data:e.period}},[t._v("\r\n              "+t._s(e.period)+"\r\n            ")]),t._v(" "),a("vs-td",{attrs:{data:e.nou}},[t._v("\r\n              "+t._s(e.nou)+"\r\n            ")]),t._v(" "),a("vs-td",{attrs:{data:e.price}},[t._v("\r\n              "+t._s(e.price)+"\r\n            ")]),t._v(" "),a("vs-td",{attrs:{data:e.currency}},[t._v("\r\n              "+t._s(e.currency)+"\r\n            ")]),t._v(" "),a("vs-td",{attrs:{data:e.permission}},[a("div",{staticClass:"flex flex-wrap"},t._l(e.permission,(function(e,s){return 1==e.status?a("div",{key:s,staticClass:"m-1 px-2 rounded-lg bg-gray-300"},[a("div",[t._v(t._s(e.name))]),t._v(" "),t._l(e.subpermissions,(function(e,s){return 1==e.status?a("div",{key:s,staticClass:"m-1 px-2 rounded-lg bg-gray-200"},[t._v(t._s(e.title))]):t._e()}))],2):t._e()})),0)]),t._v(" "),a("vs-td",{staticStyle:{width:"60px"}},[a("div",{staticClass:"flex"},[a("div",{staticClass:"flex-auto cursor-pointer",attrs:{align:"center"},on:{click:function(a){return t.inputModal("edit",e)}}},[a("i",{staticClass:"material-icons text-lg icon align"},[t._v("edit")])]),t._v(" "),a("div",{staticClass:"flex-auto cursor-pointer",attrs:{align:"center"},on:{click:function(a){return t.deleteData(e)}}},[a("i",{staticClass:"material-icons text-lg icon align"},[t._v("delete")])])])])],1)}))}}])},[a("template",{slot:"thead"},[a("vs-th",{attrs:{"sort-key":"name"}},[t._v("Name")]),t._v(" "),a("vs-th",[t._v("Description")]),t._v(" "),a("vs-th",[t._v("Period")]),t._v(" "),a("vs-th",[t._v("Number of user")]),t._v(" "),a("vs-th",[t._v("Price")]),t._v(" "),a("vs-th",[t._v("Currency")]),t._v(" "),a("vs-th",[t._v("Permissions")]),t._v(" "),a("vs-th",{staticClass:"wd-50 text-center",staticStyle:{width:"50px"}},[t._v("Action")])],1)],2)],1),t._v(" "),a("vs-popup",{attrs:{title:t.modalTitle,active:t.inputModalSt},on:{"update:active":function(e){t.inputModalSt=e}}},[a("div",{},[a("div",[a("vs-input",{staticClass:"w-full pt-3",attrs:{"label-placeholder":"Name"},model:{value:t.name,callback:function(e){t.name=e},expression:"name"}}),t._v(" "),t.errorData.name?a("div",{staticClass:"py-1 text-sm text-red-400"},[t._v(t._s(t.errorData.name[0]))]):t._e(),t._v(" "),a("div",{staticClass:"pt-6"},[a("vs-textarea",{attrs:{label:"Description"},model:{value:t.description,callback:function(e){t.description=e},expression:"description"}})],1),t._v(" "),a("div",{staticClass:"flex"},[a("div",{staticClass:"flex-auto pr-1"},[a("vs-select",{staticClass:"w-full",attrs:{placeholder:"Select",label:"Select Menu"},model:{value:t.period,callback:function(e){t.period=e},expression:"period"}},t._l(t.periodOption,(function(t,e){return a("vs-select-item",{key:e,attrs:{value:t,text:t}})})),1),t._v(" "),t.errorData.period?a("div",{staticClass:"py-1 text-sm text-red-400"},[t._v(t._s(t.errorData.period[0]))]):t._e()],1),t._v(" "),a("div",{staticClass:"flex-auto pl-1"},[a("vs-input",{staticClass:"w-full",attrs:{label:"Period value"},model:{value:t.periodvalue,callback:function(e){t.periodvalue=e},expression:"periodvalue"}}),t._v(" "),t.errorData.periodvalue?a("div",{staticClass:"py-1 text-sm text-red-400"},[t._v(t._s(t.errorData.periodvalue[0]))]):t._e()],1)]),t._v(" "),a("vs-input",{staticClass:"w-full pt-3",attrs:{"label-placeholder":"Number of user"},model:{value:t.nou,callback:function(e){t.nou=e},expression:"nou"}}),t._v(" "),t.errorData.nou?a("div",{staticClass:"py-1 text-sm text-red-400"},[t._v(t._s(t.errorData.nou[0]))]):t._e(),t._v(" "),a("vs-input",{staticClass:"w-full pt-3",attrs:{"label-placeholder":"Price"},model:{value:t.price,callback:function(e){t.price=e},expression:"price"}}),t._v(" "),t.errorData.price?a("div",{staticClass:"py-1 text-sm text-red-400"},[t._v(t._s(t.errorData.price[0]))]):t._e(),t._v(" "),a("vs-input",{staticClass:"w-full pt-3",attrs:{"label-placeholder":"Currency"},model:{value:t.currency,callback:function(e){t.currency=e},expression:"currency"}}),t._v(" "),t.errorData.currency?a("div",{staticClass:"py-1 text-sm text-red-400"},[t._v(t._s(t.errorData.currency[0]))]):t._e()],1),t._v(" "),a("div",{staticClass:"font-bold text-1xl pt-3"},[t._v("Select Module")]),t._v(" "),a("div",{staticClass:"py-4 px-8"},[t.errorData.permission?a("div",{staticClass:"py-1 text-sm text-red-400"},[t._v(t._s(t.errorData.permission[0]))]):t._e(),t._v(" "),t._l(t.moduleData,(function(e,s){return a("div",{key:s,staticClass:"py-4",staticStyle:{"border-bottom":"1px solid rgb(0,0,0,.1)"}},["group"==e.type?a("div",[a("div",{staticClass:"py-2"},[a("vs-checkbox",{on:{change:function(e){return t.permissionChanged(s,0,0,"group")}},model:{value:e.status,callback:function(a){t.$set(e,"status",a)},expression:"itemData.status"}},[t._v(t._s(e.name))])],1),t._v(" "),t._l(e.data,(function(e,i){return a("div",{key:i,staticClass:"pl-5"},[a("div",{staticClass:"py-2"},[a("vs-checkbox",{on:{change:function(e){return t.permissionChanged(s,i,0,"module")}},model:{value:e.status,callback:function(a){t.$set(e,"status",a)},expression:"item.status"}},[t._v(t._s(e.name))])],1),t._v(" "),e.subpermissions?a("div",{staticClass:"pl-8"},t._l(e.subpermissions,(function(e,n){return a("div",{key:n},[a("vs-checkbox",{on:{change:function(e){return t.permissionChanged(s,i,n,"sub")}},model:{value:e.status,callback:function(a){t.$set(e,"status",a)},expression:"sub.status"}},[t._v(t._s(e.title))])],1)})),0):t._e()])}))],2):a("div",t._l(e.data,(function(e,i){return a("div",{key:i},[a("div",{staticClass:"py-2"},[a("vs-checkbox",{on:{change:function(e){return t.permissionChanged(s,i,0,"module")}},model:{value:e.status,callback:function(a){t.$set(e,"status",a)},expression:"item.status"}},[t._v(t._s(e.name))])],1),t._v(" "),e.subpermissions?a("div",{staticClass:"pl-8"},t._l(e.subpermissions,(function(e,n){return a("div",{key:n},[a("vs-checkbox",{on:{change:function(e){return t.permissionChanged(s,i,n,"sub")}},model:{value:e.status,callback:function(a){t.$set(e,"status",a)},expression:"sub.status"}},[t._v(t._s(e.title))])],1)})),0):t._e()])})),0)])}))],2)]),t._v(" "),"new"==t.modalType?a("div",{staticClass:"pt-3",attrs:{align:"right"}},[a("vs-button",{attrs:{size:"small",disabled:t.btnDisabled},on:{click:function(e){return t.createPackage()}}},[t._v("Create")])],1):t._e(),t._v(" "),"edit"==t.modalType?a("div",{staticClass:"pt-3",attrs:{align:"right"}},[a("vs-button",{attrs:{size:"small",disabled:t.btnDisabled},on:{click:function(e){return t.updatePackage()}}},[t._v("Update")])],1):t._e()])],1)])}),[],!1,null,null,null);e.default=c.exports}}]);